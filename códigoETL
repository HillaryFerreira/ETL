from pathlib import Path
import pandas as pd

vendas_filial1 = pd.read_csv('vendas_filial1.csv')
Path = '/content/vendas_filial2.xlsx'

vendas_filial2 = pd.read_excel('vendas_filial2.xlsx')
print (vendas_filial2.head())

print("Dados da Filial 1:")
print(vendas_filial1.head())
print("\nDados da Filial 2:")
print(vendas_filial2.head())


vendas_filial1['Valor Total'] = vendas_filial1['Quantidade Vendida'] * vendas_filial1['Preço Unitário']
vendas_filial2['Valor Total'] = vendas_filial2['Quantidade Vendida'] * vendas_filial2['Preço Unitário']


print("Dados Transformados da Filial 1:")
print(vendas_filial1.head())
print("\nDados Transformados da Filial 2:")
print(vendas_filial2.head())


vendas_filial1.to_csv('vendas_filial1_transformadas.csv', index=False)
vendas_filial2.to_csv('vendas_filial2_transformadas.csv', index=False)


dados_filial1 = pd.read_csv('vendas_filial1_transformadas.csv')
dados_filial2 = pd.read_csv('vendas_filial2_transformadas.csv')

print("Dados Transformados da Filial 1 (do arquivo CSV):")
print(dados_filial1.head())
print("\nDados Transformados da Filial 2 (do arquivo CSV):")
print(dados_filial2.head())

import sqlite3

# Criar uma conexão com o banco de dados
conn = sqlite3.connect('dados_transformados.db')

# Carregar os dados transformados para tabelas SQL
vendas_filial1.to_sql('vendas_filial1_transformadas', conn, index=False, if_exists='replace')
vendas_filial2.to_sql('vendas_filial2_transformadas', conn, index=False, if_exists='replace')

# Apresentar os dados carregados das tabelas SQL
dados_filial1 = pd.read_sql("SELECT * FROM vendas_filial1_transformadas", conn)
dados_filial2 = pd.read_sql("SELECT * FROM vendas_filial2_transformadas", conn)

print("Dados Transformados da Filial 1 (do banco de dados SQL):")
print(dados_filial1.head())
print("\nDados Transformados da Filial 2 (do banco de dados SQL):")
print(dados_filial2.head())

# Fechar a conexão com o banco de dados
conn.close()

import sqlite3

# Criar uma conexão com o banco de dados
conn = sqlite3.connect('dados_transformados.db')

# Criar um cursor para executar consultas SQL
cursor = conn.cursor()

# Executar uma consulta SQL para obter os dados da tabela vendas_filial1_transformadas
cursor.execute('SELECT * FROM vendas_filial1_transformadas')

# Obter os resultados da consulta
dados_filial1 = cursor.fetchall()

# Exibir os dados da filial 1
print("Dados Transformados da Filial 1:")
for linha in dados_filial1:
    print(linha)

# Executar uma consulta SQL para obter os dados da tabela vendas_filial2_transformadas
cursor.execute('SELECT * FROM vendas_filial2_transformadas')

# Obter os resultados da consulta
dados_filial2 = cursor.fetchall()

# Exibir os dados da filial 2
print("\nDados Transformados da Filial 2:")
for linha in dados_filial2:
    print(linha)

# Fechar o cursor e a conexão com o banco de dados
cursor.close()
conn.close()
